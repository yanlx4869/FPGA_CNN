<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../static/modify_email/css/style.css">
    <link rel="stylesheet" href="../static/modify_email/iconfont/iconfont.css">
    <script type="text/javascript" src="../static/jquery-3.4.1.min.js"></script>
<style>
    h2{
        position: absolute;
        top: 140px;
        right: 2;
    }
</style>
<style>
    h1{
        font-size:larger;
        color: black;

        position: absolute;
        top: 50px;
    }
</style>


<script>
        //加载文档对象
         window.onload=function () {
             var go_back= document.getElementById("go_back")
             go_back.onclick=function () {

                 window.location.href='/personal';
             }
         }

    </script>

    <title>修改绑定邮箱</title>
    
</head>

<body>
<html>
    <div class="container" id="container">
       
        <div class="form-container sing-in-container">
            <!-- 修改绑定邮箱 -->
            <form action="/email_modify" method="post">
                <h1>修改绑定邮箱</h1>
                <input type="text" name="username" placeholder="用户名">
                <input type="text" name="password" placeholder="密码">
                <input type="email" name="email" id="emailAddress3"placeholder="绑定新邮箱">
                <button type="button" id="send_code3">发送验证码</button>
                <input type="text" name="security_code" placeholder="验证码">
                <button type="submit" id="modify">确认修改</button>
            </form>
            <script>
                $("#send_code3").click(function () {
                    var $this = $(this);
                    var a = this;
                    alert("test1");
                    email = $("#emailAddress3").val();
                    alert(email);
                    $.ajax({
                        url:"/sendEmail",
                        type:"post",
                        data:{"email":email},
                        success:function (messages) {
                            $this.off("click");
                            var countDown = 10;
                            var timer = setInterval(function(){
                                if(countDown > 0) {
                                    $this.text(countDown+"秒后重新获取");
                                
                                } else {
                                    $this.text("获取验证码");
                                    $this.on("click",function(){
                                        alert("重新获取验证码");
                                    });
                                    clearInterval(timer);
                                }
                                countDown--   
                            },1000);
                            alert(messages);
                        },
                        error:function () {
                            alert("Fail!");
                        }
                    })
                });
            </script>
            {% if status == "error2" %}
            <script>
                alert("用户名或密码错误")
            </script>
            {% elif status == "ok" %}
                <script>
                    alert("绑定邮箱修改成功")
                </script>
            {% elif status == "error1" %}
                <script>
                    alert("验证码错误")
                </script>
            {% elif status == "error3" %}
            <script>
                alert("未更换邮箱号")
            </script>
            {% elif status == "failed" %}
                <script>
                    alert("Fail！ 修改失败！")
                </script>
            {% endif %}
        </div>

        <style>
            h2{
                color:darkgreen;
                font-size:xx-large;
                font-family:'楷体', Times, serif;
                font-weight: bolder;
            }
        </style>
        <!-- 侧边栏内容 -->
        <div class="overlay-container">
            <div class="overlay">
                <div class="overlay-pannel overlay-right">
                    <div class="img">
                        <img src="../static/modify_email/img/logo.png" alt="logo"  width="156.4" height="105">
                    </div>
                    <h2>counter树冠识别系统</h2>
                    <p>绑定新邮箱</p>
                    <button  class="ghost" id="go_back">返回</button>
                </div>
            </div>
        </div>
    </div>
    <script src="../static/modify_email/modify_email.js"></script>
</body>
</html>